<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Balls Gravity Game</title>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <meta robots="noindex, nofollow">
</head>
<body>
    <h1>Score: 0</h1>
    <h2>High Score: 0</h2>
    <canvas id="canvas"></canvas>
</body>
</html>
<style>
    body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        height: 100vh;
        background-color: #e3e3e3;
    }
    canvas {
        border: 2px solid #000;
        border-radius: 10px;
    }
    h1 {
        font-family: sans-serif;
        font-size: 2em;
    }
    h2 {
        font-family: sans-serif;
        font-size: 1.5em;
    }
</style>
<script>
    var score = 0;

    var chaser_ball = {
        x: 0,
        y: 0,
        radius: 25,
        color: 'red',
        dx: 0,
        dy: 0,
        speed: 1
    }

    var target_ball = {
        x: 0,
        y: 0,
        radius: 25,
        color: 'blue',
    }

    var mouse_pos = {
        x: 0,
        y: 0
    }

    function calculate_gravity_to_position(ball, x, y, gravity_mult) {
        var angle = Math.atan2(y - ball.y, x - ball.x);
        ball.dx += Math.cos(angle) * gravity_mult;
        ball.dy += Math.sin(angle) * gravity_mult;

        ball.dx *= 0.95;
        ball.dy *= 0.95;
    }

    function check_if_chaser_hit_cursor(){
        if (mouse_pos.x == 0 && mouse_pos.y == 0) return;
        var distance = Math.sqrt(Math.pow(chaser_ball.x - mouse_pos.x, 2) + Math.pow(chaser_ball.y - mouse_pos.y, 2));
        if(distance < chaser_ball.radius){
            saveHighScore();
            score = 0;
            document.querySelector('h1').innerText = 'Score: ' + score;
            chaser_ball.x = 0;
            chaser_ball.y = 0;
            chaser_ball.speed = 1;
        }
    }

    function check_if_cursor_hit_target(){
        var distance = Math.sqrt(Math.pow(mouse_pos.x - target_ball.x, 2) + Math.pow(mouse_pos.y - target_ball.y, 2));
        if(distance < target_ball.radius){
            score++;
            document.querySelector('h1').innerText = 'Score: ' + score;
            chaser_ball.speed += 0.05;
            send_target_ball_to_new_pos();
        }
    }

    function send_target_ball_to_new_pos(){
        target_ball.x = Math.random() * canvas.width;
        target_ball.y = Math.random() * canvas.height;
    }

    function render_frame() {
        var canvas = document.getElementById('canvas');
        var ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        calculate_gravity_to_position(chaser_ball, mouse_pos.x, mouse_pos.y, 0.1);

        chaser_ball.x += chaser_ball.dx * chaser_ball.speed;
        chaser_ball.y += chaser_ball.dy * chaser_ball.speed;

        ctx.beginPath();
        ctx.arc(chaser_ball.x, chaser_ball.y, chaser_ball.radius, 0, Math.PI * 2);
        ctx.fillStyle = chaser_ball.color;
        ctx.fill();
        ctx.closePath();

        ctx.beginPath();
        ctx.arc(target_ball.x, target_ball.y, target_ball.radius, 0, Math.PI * 2);
        ctx.fillStyle = target_ball.color;
        ctx.fill();
        ctx.closePath();

        check_if_chaser_hit_cursor();
        check_if_cursor_hit_target();

        requestAnimationFrame(render_frame);
    }

    function get_canvas_coords_for_mouse_pos(event){
        var canvas = document.getElementById('canvas');
        var rect = canvas.getBoundingClientRect();
        return {
            x: event.clientX - rect.left,
            y: event.clientY - rect.top
        }
    }

    document.addEventListener('mousemove', function(event){
        mouse_pos = get_canvas_coords_for_mouse_pos(event);
    });

    function init(){
        var canvas = document.getElementById('canvas');
        canvas.width = window.innerWidth * 0.7;
        canvas.height = window.innerHeight * 0.7;

        loadHighScore();
        send_target_ball_to_new_pos();
        render_frame();
    }

    function loadHighScore(){
        var high_score = Cookies.get('high_score');
        if(high_score){
            document.querySelector('h2').innerText = 'High Score: ' + high_score;
        }
    }

    function saveHighScore(){
        var high_score = Cookies.get('high_score');
        if(!high_score || score > high_score){
            Cookies.set('high_score', score);
            document.querySelector('h2').innerText = 'High Score: ' + score;
            alert('New High Score!');
        }
    }

    document.addEventListener('DOMContentLoaded', init);
</script>